window.dataLayer=window.dataLayer||[];var productItemDetails=[];$(document).ready(function(){try{GTM.init();}catch(e){console.info(e);}});var gtmDataHandler={PDPDuplicateFilter:function(variantCode){var flag=true;$.each(dataLayer,function(i,o){try{var id=o.ecommerce.detail.products[0].id;if(id==variantCode)
{flag=false;}}catch(e){}});return flag;}}
var GTM={init:function(){GTM.PageTrigger.everyPage();var that=this;if($(".gtmInfo").data("gtm-page-list")=="Home Page"){try{GTMHomeMainBanner();GTMHomeBrandLogo();GTMHomeSmallBanner();GTMHomePromotionalBanners();dataLayer.push({'event':'promotionView','ecommerce':{'promoView':{'promotions':productItemDetails.slice(0,16)}}});arrImpressionPush(productItemDetails,16,16,"promotionView");}catch(e){}}
if($(".homeProductCarousel").length&&$(".gtmInfo").length){if($(".gtmPromotionFeature").length||$(".gtmPromotionHappytime").length){gtmPromotionFeatureImpression();}else{gtmPLPImpression();}}
$('.home .product-promote .item a, .home .search-container .item a, .mobile .product-container .item a').click(function(){gtmPLPClick($(this).parents(".padding").children('.homeProductCarousel'),'other page');});$(".emailSubmit").click(function(){GTMNewsletter();});if($(".gtmPromotionFeature").length||$(".gtmPromotionHappytime").length){GTMPromotionMainBanner();GTMPromotionPromotionalBanners();dataLayer.push({'event':'promotionView','ecommerce':{'promoView':{'promotions':productItemDetails.slice(0,16)}}});}
if($(".gtmPDP").length){gtmPDPImpression();}
if($(".my-cart-container .my-cart").length){GTMCheckoutSteps("1","step1")}
if($(".gtmConfirmation").length){GTMConfirmation();}
var pageList=$(".gtmInfo").data("gtm-page-list");if(pageList=="Product Listing Page"||pageList=="Category Landing Page"){GTM.PageTrigger.pageView();}},PageTrigger:{hardCodeArray:new Array(),init:function(){},pageView:function(){var that=this;window.dataLayer=window.dataLayer||[];var pageCategory=$("#product-list").data("gtm-page-category");var dataLayerJson={};if(pageCategory!=undefined&&pageCategory!=null){dataLayerJson=$.extend({},dataLayerJson,{'page_category':pageCategory});}
dataLayer.push(dataLayerJson);},everyPage:function(){var that=this;window.dataLayer=window.dataLayer||[];var dataLayerJson={};var gtm_hidden=$(".gtm_hidden");$.each(gtm_hidden,function(i,o){var name=$(o).attr("name");if(name!=null&&name!=""){var value=that.setValue(name);dataLayerJson[name]=value;}});if(dataLayerJson!="{}"){dataLayer.push(dataLayerJson);}},setValue:function(name){var that=this;var value=$(".gtmContentDiv").data("gtm-"+name.toLowerCase())==undefined?"":$(".gtmContentDiv").data("gtm-"+name.toLowerCase());var pageType=that.getPageType(name);var pageSection=that.getPageSection(name);var productLabelAttributes=that.getProductLabelAttributes(name);value=(pageType!=""?pageType:value);value=(pageSection!=""?pageSection:value);value=(productLabelAttributes!=null&&productLabelAttributes.length>0)?productLabelAttributes:value;if(!(value instanceof Object)){value=(value+"").replace(/zt/g,"zh-hk").toLowerCase();}
return value;},getProductLabelAttributes:function(key){var labels=[];if(key=="product_label_attributes"){$("#special-offers").find(".grid-item").each(function(i,o){labels.push($(o).find(".title").text());});}
return labels;},getPageType:function(key){var _value="";var pathname=window.location.pathname.toLowerCase();var isocode=Cookie.get("lang").replace(/zt/g,"zh-hk");var existProduct=$(".product-content").length>0?true:false;if(key=="page_type"){if(pathname=="/"+isocode+"/"||pathname=="/"+isocode+"/watsonsmall"){_value="homepage";}else if(pathname.indexOf("/lc/")>-1||pathname.indexOf("/c/")>-1||pathname.indexOf("/wmc/")>-1||pathname.indexOf("/wmlc/")>-1){_value="category";}else if(pathname.indexOf("/search")>-1){if(existProduct){_value="search-results";}else{_value="search-no-results";}}else if(pathname.indexOf("/brandlist")>-1||pathname.indexOf("/b/")>-1||pathname.indexOf("/wmb/")>-1){_value="brand-list";}else if(pathname.indexOf("/p/")>-1){_value="product-details";}else if(pathname.indexOf("/shoppingcart")>-1){_value="checkout-1";}else if(pathname.indexOf("/checkout")>-1){if(pathname.indexOf("/step")>-1){_value="checkout-"+pathname.substring(pathname.lastIndexOf("/")>-1?pathname.lastIndexOf("/"):0).replace("/step","");}else if(pathname.indexOf("/register")>-1){_value="checkout-register";}else{_value="checkout-confirmation";}}else if(pathname.indexOf("/login")>-1){_value="login-register";}else if(pathname.indexOf("/register")>-1){_value="registration";}else if(pathname.indexOf("/my-account")){if(pathname.indexOf("/update-profile")>-1){_value="personal-details";}else if(pathname.indexOf("/addressbookpage")>-1){_value="address-book";}else if(pathname.indexOf("/shoppinglist")>-1){var text=$(".btn-my-list.selected").find(".label").html();if(text!=undefined&&text!=null&&text.toLowerCase()=="notify"){_value="notify-me";}else{_value="wishlist";}}else if(pathname.indexOf("/orders")>-1){_value="order-history";}else if(pathname.indexOf("/mywallet")>-1){_value="ecoupons-evoucher";}else if(pathname.indexOf("/rateproducts")>-1){_value="rating-reviews";}else if(pathname.indexOf("/moneyBack")>-1){_value="points-balance";}else{_value="account-summary";}}else if(pathname.indexOf("/promo/featured")>-1||pathname.indexOf("/newpromotion")>-1){_value="promotion";}else if($(document).find("body").hasClass("staticPage")){_value="static page";}else if(pathname.indexOf("store")>-1&&pathname.indexOf("locator")>-1){_value="stores-overview";}}
return _value;},getPageSection:function(key){var pathname=window.location.pathname.toLowerCase();var _value="";if(key=="page_section")
{if(pathname.indexOf("/checkout")>-1){_value="checkout";}
else if((pathname.indexOf("/my-account")>-1&&!pathname.indexOf("/checkout")<0)||pathname.indexOf("/login")>-1||pathname.indexOf("/register")>-1){_value="my-account";}
else if(pathname.indexOf("store")>-1&&pathname.indexOf("locator")>-1){_value="store-locator";}
else if($(document).find("body").hasClass("staticPage")){_value="static";}else{_value="shopping";}}
return _value;},},shareProduct:{add:function(products){if(!$.isEmptyObject(products)){dataLayer.push({'event':'share','ecommerce':{'products':products}});}}}}
function GTMHomeMainBanner(){$('.gtmMainbanner').each(function(index){var rotatingBannerImg=getImgTitle($(this).attr("src"));var rotatingBannerPos=getImgPos(index,"banner-carousel-");productItemDetails.push({'id':rotatingBannerImg,'position':rotatingBannerPos});})
$(".gtmMainBannerClick").click(function(){var rotatingBannerImg=getImgTitle($(this).find(".gtmMainbanner").attr("src"));var rotatingBannerPos=getImgPos($(this).data("index"),"banner-carousel-");promotionClick(rotatingBannerImg,rotatingBannerPos);});}
function GTMHomeBrandLogo(){$('.gtmBrandLogo').each(function(index){var rotatingBannerPos=getImgPos(index,"brand-logo-");productItemDetails.push({'id':$(this).data("gtm-brandlogo-name"),'position':rotatingBannerPos});})
$(".gtmBrandLogo").click(function(){var rotatingBannerPos=getImgPos($(".gtmBrandLogo").index(this),"brand-logo-");promotionClick($(this).data("gtm-brandlogo-name"),rotatingBannerPos);});}
function GTMHomeSmallBanner(){$('.gtmSmallBanner').each(function(index){var rotatingBannerImg=getImgTitle($(this).data("gtm-smallbanner-img"));var rotatingBannerPos=getImgPos(index,"4-col-small-banner-");productItemDetails.push({'id':rotatingBannerImg,'position':rotatingBannerPos});})
$(".gtmSmallBanner").click(function(){var rotatingBannerIndex=$(".gtmSmallBanner").index(this);var rotatingBannerImg=getImgTitle($(this).data("gtm-smallbanner-img"));var rotatingBannerPos=getImgPos(rotatingBannerIndex,"4-col-small-banner-");promotionClick(rotatingBannerImg,rotatingBannerPos);});}
function GTMHomePromotionalBanners(){$('.gtmPromotionalBanners').each(function(index){var rotatingBannerImg=getImgTitle($(this).data("gtm-promotionalbanners-img"));var rotatingBannerPos=getImgPos(index,"promotional-banners-");productItemDetails.push({'id':rotatingBannerImg,'position':rotatingBannerPos});});$(".gtmPromotionalBanners").click(function(){var rotatingBannerPos=getImgPos($(".gtmPromotionalBanners").index(this),"promotional-banners-");var rotatingBannerImg=getImgTitle($(this).data("gtm-promotionalbanners-img"));promotionClick(rotatingBannerImg,rotatingBannerPos);});}
function onPromoClick(promoObj){dataLayer.push({'event':'promotionClick','ecommerce':{'promoClick':{'promotions':[{'id':promoObj.id,'name':promoObj.name,'creative':promoObj.creative,'position':promoObj.position}]}}});}
function GTMPromotionMainBanner(){$('.gtmMainbanner').each(function(index){var code=$(this).data("promotionalbanners-code");var rotatingBannerImg=getImgTitle($(this).attr("data-src-desktop"));var altTitle=$(this).attr("alt")?$(this).attr("alt"):$(this).attr("title");var promotionTag=$(".promotion .tab-container ul li.selected").find("span").html();var promoMainBannerPos=getImgPos(index,"promotion_"+promotionTag+"_");productItemDetails.push({'id':code,'name':altTitle,'creative':rotatingBannerImg,'position':promoMainBannerPos});});$(".gtmMainBannerClick").click(function(){var code=$(this).data("promotionalbanners-code");var rotatingBannerImg=getImgTitle($(this).find(".gtmMainbanner").attr("src"));var altTitle=$(this).find(".gtmMainbanner").attr("alt")?$(this).find(".gtmMainbanner").attr("alt"):$(this).find(".gtmMainbanner").attr("title");var promotionTag=$(".promotion .tab-container ul li.selected").find("span").html();var promoMainBannerPos=getImgPos($(this).data("index"),"promotion_"+promotionTag+"_");var promoObj=new Object();promoObj.id=code;promoObj.name=altTitle;promoObj.creative=rotatingBannerImg;promoObj.position=promoMainBannerPos;onPromoClick(promoObj);});}
function GTMPromotionPromotionalBanners(){$('.gtmPromotionalBanners').each(function(index){var code=$(this).data("promotionalbanners-code");var rotatingBannerImg=getImgTitle($(this).data("gtm-promotionalbanners-img"));var name=$(this).attr("data-promotionalbanners-name");var promoTitle=$(this).closest(".margin").find("h1").html();var promoMainBannerPos;if($(this).closest(".new-in-brands").length>0){promoMainBannerPos=getImgPos($(".new-in-brands .gtmPromotionalBanners").index(this),"promotion_"+promoTitle+"_");}else if($(this).closest(".featured-promotion").length>0){promoMainBannerPos=getImgPos($(".featured-promotion .gtmPromotionalBanners").index(this),"promotion_"+promoTitle+"_");}else{promoMainBannerPos=getImgPos($(".gtmPromotionalBanners").index(this),"promotion_"+promoTitle+"_");}
productItemDetails.push({'id':code,'name':name,'creative':rotatingBannerImg,'position':promoMainBannerPos});});$(".gtmPromotionalBanners").click(function(){var code=$(this).data("promotionalbanners-code");var rotatingBannerImg=getImgTitle($(this).data("gtm-promotionalbanners-img"));var name=$(this).attr("data-promotionalbanners-name");var promoTitle=$(this).closest(".margin").find("h1").html();var promoMainBannerPos;if($(this).closest(".new-in-brands").length>0){promoMainBannerPos=getImgPos($(".new-in-brands .gtmPromotionalBanners").index(this),"promotion_"+promoTitle+"_");}else if($(this).closest(".featured-promotion").length>0){promoMainBannerPos=getImgPos($(".featured-promotion .gtmPromotionalBanners").index(this),"promotion_"+promoTitle+"_");}else{promoMainBannerPos=getImgPos($(".gtmPromotionalBanners").index(this),"promotion_"+promoTitle+"_");}
var promoObj=new Object();promoObj.id=code;promoObj.name=name;promoObj.creative=rotatingBannerImg;promoObj.position=promoMainBannerPos;onPromoClick(promoObj);});}
function promotionClick(itemId,itePposition){try{window.dataLayer=window.dataLayer||[];dataLayer.push({'event':'promotionClick','ecommerce':{'promoClick':{'promotions':[{'id':itemId,'position':itePposition}]}}});}catch(e){}}
function getImgTitle(item){imgTitle=item.substr(item.lastIndexOf('/')+1);return imgTitle;}
function getImgPos(index,name){var imgPos=index+1;imgPos=name+imgPos;return imgPos;}
function productClickGTM(name,id,price,brand,category,variant,position,list,category_id){try{window.dataLayer=window.dataLayer||[];var json={'name':name,'id':id,'price':price,'brand':brand,'category':category,'category_id':category_id,'variant':variant,'position':position}
dataLayer.push({'event':'productClick','ecommerce':{'click':{'actionField':{'list':list},'products':[json]}}});}catch(e){}}
function variantCode(prodId,variantCode){try{var variant=variantCode;if(variantCode==''){variant=prodId.replace("BP_","");}
return variant+"";}catch(e){}}
function arrImpressionPush(arrName,arrFirst,arrRange,eventName){try{var arrCurrent=arrFirst;var arrToBePush=0;var event="impression";while(arrName.length-arrCurrent>0){if(arrName.length-arrCurrent>arrRange){arrToBePush=arrRange;}else{arrToBePush=arrName.length-arrCurrent;}
var ecommerce={'impressions':arrName.slice(arrCurrent,arrCurrent+arrToBePush)};if(eventName!=undefined&&eventName=="promotionView"){event=eventName;ecommerce={'promoView':{'promotions':arrName.slice(arrCurrent,arrCurrent+arrToBePush)}}}
var dataLayerJson={'event':event,'ecommerce':ecommerce};dataLayer.push(dataLayerJson);arrCurrent=arrCurrent+arrRange;}}catch(e){}}
function gtmPDPYouMayAlsoLike(){try{var prodDetail=[];$(".gtmPDP .homeProductCarousel").each(function(index){if($(this).is(":visible")){var baseProductJson=retBaseProductJson(this,'homeproductcarousel');var productDetailJson=$.extend({},baseProductJson,{'list':"Product Detail Page – You May Also Like",'position':index+1});prodDetail.push(productDetailJson);}});arrImpressionPush(prodDetail,0,5);$(".item a").click(function(){var productClick=$(this).parents(".padding").children('.homeProductCarousel');var dataName="homeproductcarousel";var index=$(".homeProductCarousel").index(productClick)+1;var name=getProductName(productClick,dataName);var id=variantCode(productClick.attr("data-gtm-"+dataName+"-id"),productClick.attr("data-gtm-"+dataName+"-variant"));var price=productClick.attr("data-gtm-"+dataName+"-price");var brand=productClick.attr("data-gtm-"+dataName+"-brand");var category=productClick.attr("data-gtm-"+dataName+"-category");var variant=variantCode(productClick.attr("data-gtm-"+dataName+"-id"),productClick.attr("data-gtm-"+dataName+"-variant"));var category_id=productClick.attr("data-gtm-"+dataName+"-category_id");var list=$(".gtmInfo").data("gtm-page-list");productClickGTM(name,id,price,brand,category,variant,index,list,category_id);});}catch(e){}}
function gtmPDPRedemption(viewMore){try{var selector=".gtmRedemption.redemptionProduct:first";if(viewMore=="viewMore"){selector=".gtmRedemption.redemptionProduct:not(:first)";}
var prodDetail=[];$(selector).each(function(index){var selectorIndex=index+1;if(viewMore=="viewMore"){selectorIndex=index+2;}
var baseProductJson=retBaseProductJson(this,'redemption');var productDetailJson=$.extend({},baseProductJson,{'list':"Product Detail Page - Redemption",'position':selectorIndex});prodDetail.push(productDetailJson);});arrImpressionPush(prodDetail,0,5);}catch(e){}}
function gtmRedemptionAddtoCart(productID,redemProductID,quantity){try{dataLayer.push({'event':'addToCart','ecommerce':{'add':{'products':gtmProductDetail('.gtmRedemption[data-gtm-redemption-id="'+productID+'"]:first, .gtmRedemption[data-gtm-redemption-id="'+redemProductID+'"]','redemption','sameAsVariant',quantity)}}});}catch(e){}}
function gtmPDPImpression(variantCode){try{var itemVariant='sameAsVariant';if($('.colorAndSizeContainer').children().length!=0){if(variantCode!=undefined){itemVariant=variantCode.toString();}}
var dataLayerJson={'ecommerce':{'detail':{'actionField':{'list':'Product Detail Page'},'products':gtmProductDetail('.gtmPDP','pdp',itemVariant)}}};if(gtmDataHandler.PDPDuplicateFilter(variantCode))
dataLayer.push(dataLayerJson);}catch(e){}}
function gtmPDPAddtoCart(variant,quantity){try{dataLayer.push({'event':'addToCart','ecommerce':{'add':{'products':gtmProductDetail('.gtmPDP','pdp',variant,quantity)}}});}catch(e){}}
function gtmPLPImpression(){try{var arrRange=16;if($(".gtmInfo").data("gtm-page-list")=="Home Page"){arrRange=10;}
arrImpressionPush(gtmProductDetail('.homeProductCarousel','homeproductcarousel','defaultValue',undefined,$(".gtmInfo").data("gtm-page-list"),'defaultValue'),0,arrRange);}catch(e){}}
function gtmPromotionFeatureImpression(){try{var arrRange=16;arrImpressionPush(gtmProductDetail('.homeProductCarousel','homeproductcarousel','defaultValue',undefined,$(".gtmInfo").data("gtm-page-list"),'defaultValue'),0,arrRange);}catch(e){}}
function gtmPLPClick(productDetailContainer,gtmPage){try{var dataName='pdp';if(gtmPage=='other page'){dataName='homeproductcarousel';}
var index=$(".homeProductCarousel[data-gtm-homeproductcarousel-id='"+productDetailContainer.attr("data-gtm-"+dataName+"-id")+"']").parents(".item").index()+1;var name=getProductName(productDetailContainer,dataName);var id=variantCode(productDetailContainer.attr("data-gtm-"+dataName+"-id"),productDetailContainer.attr("data-gtm-"+dataName+"-variant"));var price=productDetailContainer.attr("data-gtm-"+dataName+"-price");var brand=productDetailContainer.attr("data-gtm-"+dataName+"-brand");var category=productDetailContainer.attr("data-gtm-"+dataName+"-category");var variant=variantCode(productDetailContainer.attr("data-gtm-"+dataName+"-id"),productDetailContainer.attr("data-gtm-"+dataName+"-variant"));var category_id=productDetailContainer.attr("data-gtm-"+dataName+"-category_id");var list=$(".gtmInfo").data("gtm-page-list");productClickGTM(name,id,price,brand,category,variant,index,list,category_id);}catch(e){}}
function gtmProductDetail(dataClass,dataName,variant,quantity,list,position){try{var prodDetail=[];$(dataClass).each(function(index){var itemID
if(variant!='defaultValue'){var itemVariant=variant;}else{var itemVariant=variantCode($(this).data('gtm-'+dataName+'-id'),$(this).data('gtm-'+dataName+'-variant')).toString();}
if(variant=='sameAsVariant'){var itemVariant=$(this).data('gtm-'+dataName+'-variant');itemID=itemVariant;}else{itemID=$(this).data('gtm-'+dataName+'-id').toString();}
if(position!='defaultValue'){var itemPosition=index+1;}else{var itemPosition=$(this).data('gtm-'+dataName+'-position');}
if(dataName=="pdp"&&$.isNumeric(variant)){itemID=itemVariant;}
if(dataName=='homeproductcarousel'&&$.isNumeric(variant)){itemID=itemVariant;}
if($(this).is(":visible")||dataClass==".gtmSteps."+itemID){var baseProductJson=retBaseProductJson(this,dataName);prodDetail.push(baseProductJson);if(quantity=='defaultValue'){prodDetail[index]['quantity']=$(this).data('gtm-'+dataName+'-qty');}else if(quantity!==undefined){prodDetail[index]['quantity']=parseInt(quantity);}
if(list!==undefined){prodDetail[index]['list']=list;}
if(position!==undefined){prodDetail[index]['position']=itemPosition;}}});return prodDetail;}catch(e){}}
function GTMRegistration(){try{dataLayer.push({'eventCategory':'sign_in','eventAction':'01-sign-in_click','eventLabel':'sign_in-sucess','event':'registration'});}catch(e){}}
function GTMNewsletter(){try{dataLayer.push({'eventCategory':'Newsletter','eventAction':'Subscribed','eventLabel':'','event':'newsletterSubscription'});}catch(e){}}
function GTMRemoveFromCart(variant,quantity){try{var removeClass='.gtmSteps.'+variant;dataLayer.push({'event':'removeFromCart','ecommerce':{'remove':{'products':gtmProductDetail(removeClass,'step1','sameAsVariant',quantity)}}});}catch(e){}}
function GTMAddToCart(variant,quantity){try{var removeClass='.gtmSteps.'+variant;dataLayer.push({'event':'addToCart','ecommerce':{'add':{'products':gtmProductDetail(removeClass,'step1','sameAsVariant',quantity)}}});}catch(e){}}
function GTMCheckoutSteps(step,dataName){try{var dataLayerJson={'event':'checkout','ecommerce':{'checkout':{'actionField':{'step':step},'products':gtmProductDetail(".gtmSteps",dataName,'sameAsVariant','defaultValue')}}};dataLayer.push(dataLayerJson);$(".my-cart-container .item-group .item a").click(function(){var parent=$(this).parents(".item-group");var productCode=$(parent).find(".product-code").text();var productClick=$(parent).children('.gtmSteps.'+productCode);var index=$(parent).index()+1;var name=getProductName(productClick,dataName);var id=variantCode(productClick.attr("data-gtm-"+dataName+"-id"),productClick.attr("data-gtm-"+dataName+"-variant"));var price=productClick.attr("data-gtm-"+dataName+"-price");var brand=productClick.attr("data-gtm-"+dataName+"-brand");var category=productClick.attr("data-gtm-"+dataName+"-category");var variant=variantCode(productClick.attr("data-gtm-"+dataName+"-id"),productClick.attr("data-gtm-"+dataName+"-variant"));var category_id=productClick.attr("data-gtm-"+dataName+"-category_id");var list={'action':'click','list':dataName};productClickGTM(name,id,price,brand,category,variant,index,list,category_id);});}catch(e){}}
function GTMConfirmation(){try{var GTMShippingFee="0";if(!$('.gtmConfirmation').data('gtm-confirmation-freeshipping')){GTMShippingFee=$('.gtmConfirmation').data('gtm-confirmation-shippingfee');}
window.dataLayer=window.dataLayer||[];var dataLayerJson={'event':'purchase','ecommerce':{'purchase':{'actionField':{'id':$(".gtmConfirmation").data('gtm-confirmation-orderid').toString(),'revenue':$(".gtmConfirmation").data('gtm-confirmation-revenue').toString(),'shipping':GTMShippingFee,'customer_online_orders':$(".gtmConfirmation").data('gtm-confirmation-customer_online_orders'),'coupon':""},'products':gtmProductDetail(".gtmConfirmation",'confirmation','sameAsVariant','defaultValue')}}};dataLayer.push(dataLayerJson);var gtmConfirmationTransactionAndStore=$("#gtmConfirmationTransactionAndStore");var dataLayerJson_trans_store={};var dataMap=['transaction_delivery_type','transaction_payment_type','transaction_evoucher_deducted','transaction_points_deducted','transaction_points_discount','transaction_points_earned','transaction_net_revenue'];if(gtmConfirmationTransactionAndStore.data('gtm-confirmation-store_name')!="")
{dataMap.push('store_name','store_id','store_city','store_postal_code');}
dataMap.forEach(function(col){dataLayerJson_trans_store[col]=gtmConfirmationTransactionAndStore.data('gtm-confirmation-'+col);});dataLayer.push(dataLayerJson_trans_store);}catch(e){}}
function GTMPLPAddToCart(that,result){var gtmAddToCartData=that.parents(".padding").children('.homeProductCarousel');var productItemDetail=[];var baseProductJson=retBaseProductJson(gtmAddToCartData,'homeproductcarousel');productItemDetail.push($.extend({},baseProductJson,{'quantity':1}));try{window.dataLayer=window.dataLayer||[];if(result=="add"){dataLayer.push({'event':'addToCart','ecommerce':{'add':{'products':productItemDetail}}});}else if(result=="remove"){dataLayer.push({'event':'removeFromCart','ecommerce':{'remove':{'products':productItemDetail}}});}}catch(e){}}
function retBaseProductJson(that,dataName){var name=getProductName(that,dataName);var id=$(that).data('gtm-'+dataName+'-id');var price=$(that).data('gtm-'+dataName+'-price').toString();var brand=$(that).data('gtm-'+dataName+'-brand');var category=$(that).data('gtm-'+dataName+'-category');var variant=$(that).data('gtm-'+dataName+'-variant');var category_id=$(that).data('gtm-'+dataName+'-category_id').toString();var _variantCode=variantCode(id,variant);var productItem={'name':name,'id':_variantCode,'price':price,'brand':brand,'category':category,'variant':_variantCode,'category_id':category_id};return productItem;}
function getProductName(that,dataName){var productName=$(that).data('gtm-'+dataName+'-name').toString();var brandName=$(that).data('gtm-'+dataName+'-brand');var variantName=$(that).data('gtm-'+dataName+'-variant_name');var name=productName;try{name="["+brandName+"]"+productName+(variantName!=null&&variantName!=""?"|"+variantName:"");}catch(e){name=productName;}
return name;}
function gtmPromotionFeatured(){try{var prodDetail=[];$(".promotion.landing .homeProductCarousel").each(function(index){if($(this).is(":visible")){var baseProductJson=retBaseProductJson(this,'homeproductcarousel');var productDetailJson=$.extend({},baseProductJson,{'list':"Promotion Feature Page",'position':index+1});prodDetail.push(productDetailJson);}});initGTMProductClick();}catch(e){}}
function initGTMProductClick(){$(".product-container .item a").click(function(){var productClick=$(this).parents(".padding").children('.homeProductCarousel');var name=getProductName(productClick,'homeproductcarousel');var dataName="homeproductcarousel";var index=$(".homeProductCarousel").index(productClick)+1;var id=variantCode(productClick.attr("data-gtm-"+dataName+"-id"),productClick.attr("data-gtm-"+dataName+"-variant"));var price=productClick.attr("data-gtm-"+dataName+"-price");var brand=productClick.attr("data-gtm-"+dataName+"-brand");var category=productClick.attr("data-gtm-"+dataName+"-category");var variant=variantCode(productClick.attr("data-gtm-"+dataName+"-id"),productClick.attr("data-gtm-"+dataName+"-variant"));var category_id=productClick.attr("data-gtm-"+dataName+"-category_id");var list=$(".gtmInfo").data("gtm-page-list");productClickGTM(name,id,price,brand,category,variant,index,list,category_id);});}
function gtmPromotionHappyTime(){try{var prodDetail=[];$(".promotion.general.product-list .homeProductCarousel").each(function(index){if($(this).is(":visible")){var baseProductJson=retBaseProductJson(this,'homeproductcarousel');var productDetailJson=$.extend({},baseProductJson,{'list':"Promotion HappyTime Page",'position':index+1});prodDetail.push(productDetailJson);}});arrImpressionPush(prodDetail,0,16);initGTMProductClick();}catch(e){}}
function gtmPDPAddWishList(variant){try{dataLayer.push({'event':'addToWishlist','ecommerce':{'add':{'products':gtmProductDetail('.gtmPDP','pdp',variant)}}});}catch(e){}}
function GTMPLPAddWishList(that){var prodDetail=[];var gtmAddWishListData=that.parents(".padding").children('.homeProductCarousel');var baseProductJson=retBaseProductJson(gtmAddWishListData,'homeproductcarousel');prodDetail.push(baseProductJson);try{window.dataLayer=window.dataLayer||[];dataLayer.push({'event':'addToWishlist','ecommerce':{'add':{'products':prodDetail}}});}catch(e){}}
function GTMAddWishList(variant){try{var addToClass='.gtmSteps.'+variant;dataLayer.push({'event':'addToWishlist','ecommerce':{'add':{'products':gtmProductDetail(addToClass,'step1','sameAsVariant')}}});}catch(e){}}
function GTMNewLetterSubscription(emailvalue){try{dataLayer.push({'event':'newsletterSubscription','subscribed_emailSHA':emailvalue});}catch(e){}}
function GTMRegister(emailvalue){try{dataLayer.push({'event':'register','subscribed_emailSHA':emailvalue});}catch(e){}}